RECORD_COUNT	Number of records in the data file, including header and footer if provided	INTEGER	M


Dayvigo RC
Dayvigo RC

Select distinct n.factopportunityname, Druglistmatchkey
from  DWMedProStaging.phm.tbExposureAndEngagementActivity(nolock) n 
where startdatekey>='20200701' and enddatekey<='20200731' and Druglistmatchkey in ('5219')

--verify botclick logick and chnage top query to verify as per feeds.

Select distinct n.MasterUserID,n.Druglistmatchkey 
from  DWMedProStaging.phm.tbExposureAndEngagementActivity(nolock) n where startdatekey='20200701' and enddatekey='20200731' and Druglistmatchkey in ('5219') and
 n.MasterUserid in (
 Select distinct a.MasterUserID from newsletterarchivepro.nl.activity (nolock) a,newsletterarchivepro.nl.driver (nolock) b
 where a.isbotclicked= 1 and convert(varchar(10),a.CreateDTTM  ,112)>='20200701' and
 convert(varchar(10),a.CreateDTTM  ,112)<='20200731'
 --and b.BroadCastID in ('enhertu-dociq-2020','/resource-centers/quick-quiz-metastatic-her2-breast-cancer')
 )


--record count 85

--Activity

Select count(*) Record_count from (
Select TRANSACTION_ID,SESSION_ID,PARENT_TRANSACTION_ID,CONTENT_LOCATION_NAME,CHANNEL_NAME,
SOURCE_HCP_ID_QUAL,SOURCE_HCP_ID,ACTIVITY_NAME,ACTIVITY_DATETIME,ACTIVITY_DURATION_VALUE,
DEVICE_TYPE_NAME,CAMPAIGN_CODE,CAMPAIGN_NAME,BRAND_NAME,PLACEMENT_NAME,PUBLISHER_PRODUCT_CODE,
PUBLISHER_PRODUCT_NAME,PUBLISHER_PRODUCT_START_DATETIME,PUBLISHER_PRODUCT_END_DATETIME,TACTIC_CODE,
TACTIC_NAME,EVENT_CODE,REFERRAL_ID_QUAL,REFERRAL_ID,REFERRAL_CONTENT_ID,TRAFFIC_SOURCE_TYPE_NAME,CONTENT_ID,
CONTENT_NAME,DESTINATION_ID_QUAL,DESTINATION_ID,DESTINATION_CONTENT_ID,KEY_MSG_DESC,KEY_MSG_1,KEY_MSG_2,KEY_MSG_3,
KEY_MSG_4,KEY_MSG_5,ATTRIBUTE1_VALUE_QUAL,ATTRIBUTE1_VALUE,ATTRIBUTE2_VALUE_QUAL,ATTRIBUTE2_VALUE,ATTRIBUTE3_VALUE_QUAL,
ATTRIBUTE3_VALUE,ATTRIBUTE4_VALUE_QUAL,ATTRIBUTE4_VALUE,ATTRIBUTE5_VALUE_QUAL,ATTRIBUTE5_VALUE,ATTRIBUTE6_VALUE_QUAL,
ATTRIBUTE6_VALUE,ATTRIBUTE7_VALUE_QUAL,ATTRIBUTE7_VALUE,ATTRIBUTE8_VALUE_QUAL,ATTRIBUTE8_VALUE,ATTRIBUTE9_VALUE_QUAL,
ATTRIBUTE9_VALUE,ATTRIBUTE10_VALUE_QUAL,ATTRIBUTE10_VALUE,ATTRIBUTE11_VALUE_QUAL,ATTRIBUTE11_VALUE,ATTRIBUTE12_VALUE_QUAL,
ATTRIBUTE12_VALUE,ATTRIBUTE13_VALUE_QUAL,ATTRIBUTE13_VALUE,ATTRIBUTE14_VALUE_QUAL,ATTRIBUTE14_VALUE,ATTRIBUTE15_VALUE_QUAL,
ATTRIBUTE15_VALUE,ATTRIBUTE16_VALUE_QUAL,ATTRIBUTE16_VALUE,ATTRIBUTE17_VALUE_QUAL,ATTRIBUTE17_VALUE,ATTRIBUTE18_VALUE_QUAL,
ATTRIBUTE18_VALUE,ATTRIBUTE19_VALUE_QUAL,ATTRIBUTE19_VALUE,ATTRIBUTE20_VALUE_QUAL,ATTRIBUTE20_VALUE,ATTRIBUTE21_VALUE_QUAL,
ATTRIBUTE21_VALUE,ATTRIBUTE22_VALUE_QUAL,ATTRIBUTE22_VALUE,ATTRIBUTE23_VALUE_QUAL,ATTRIBUTE23_VALUE,ATTRIBUTE24_VALUE_QUAL,ATTRIBUTE24_VALUE,ATTRIBUTE25_VALUE_QUAL,ATTRIBUTE25_VALUE
from DWMedProStaging.phm.tbExposureAndEngagementActivity(nolock)
where startdatekey>='20200701' and enddatekey<='20200731' and Druglistmatchkey in ('5219'))TGT

Select CONTENT_LOCATION_NAME,CHANNEL_NAME,
SOURCE_HCP_ID_QUAL,ACTIVITY_NAME,
BRAND_NAME,PLACEMENT_NAME,
PUBLISHER_PRODUCT_NAME,
 COUNT(*) COUNT
from DWMedProStaging.phm.tbExposureAndEngagementActivity(nolock)
where  startdatekey='20200701' and enddatekey='20200731' and Druglistmatchkey in ('5219')
GROUP BY CONTENT_LOCATION_NAME,CHANNEL_NAME,
SOURCE_HCP_ID_QUAL,ACTIVITY_NAME,
BRAND_NAME,PLACEMENT_NAME,
PUBLISHER_PRODUCT_NAME

Select CONTENT_LOCATION_NAME,CHANNEL_NAME,
SOURCE_HCP_ID_QUAL,ACTIVITY_NAME,
BRAND_NAME,
PUBLISHER_PRODUCT_NAME,BROADCASTNAME,
 COUNT(*) COUNT
from DWMedProStaging.phm.tbExposureAndEngagementActivity(nolock)
where  startdatekey='20200701' and enddatekey='20200731' and Druglistmatchkey in ('5219')
GROUP BY CONTENT_LOCATION_NAME,CHANNEL_NAME,
SOURCE_HCP_ID_QUAL,ACTIVITY_NAME,
BRAND_NAME,
PUBLISHER_PRODUCT_NAME,BROADCASTNAME


Select distinct
CONTENT_LOCATION_NAME, SOURCE_HCP_ID_QUAL,SOURCE_HCP_ID, ACTIVITY_NAME, ACTIVITY_DATETIME,BRAND_NAME
from DWMedProStaging.phm.tbExposureAndEngagementActivity(nolock)
where  startdatekey='20200701' and enddatekey='20200731' and Druglistmatchkey in ('5219')
and (CONTENT_LOCATION_NAME is null or
SOURCE_HCP_ID_QUAL is null or
SOURCE_HCP_ID is null or ACTIVITY_NAME is null or ACTIVITY_DATETIME is null or BRAND_NAME is null)

--summary


Select CONTENT_LOCATION_NAME,SOURCE_HCP_ID_QUAL,BRAND_NAME,Tactic_code,Tactic_name, count(*)Counts
from  DWMedProStaging.phm.tbExposureAndEngagementActivity(nolock)
where  startdatekey='20200808' and enddatekey='20200814' and Druglistmatchkey in ('4955')
and factopportunityname ='Mayzent Doc IQ'
--'Dayvigo RC'
group by CONTENT_LOCATION_NAME,SOURCE_HCP_ID_QUAL,BRAND_NAME,Tactic_code,Tactic_name;

Select factopportunityname,CONTENT_LOCATION_NAME,SOURCE_HCP_ID_QUAL,ACTIVITY_NAME,BRAND_NAME, count(*)Counts
from  DWMedProStaging.phm.tbExposureAndEngagementActivity(nolock)
where  startdatekey='20200808' and enddatekey='20200814' and Druglistmatchkey in ('4955')
and factopportunityname ='Mayzent Doc IQ'
--'Dayvigo RC'
group by CONTENT_LOCATION_NAME,SOURCE_HCP_ID_QUAL,ACTIVITY_NAME,BRAND_NAME,factopportunityname;


Select CONTENT_LOCATION_NAME,CHANNEL_NAME,
SOURCE_HCP_ID_QUAL,ACTIVITY_NAME,
BRAND_NAME,
PUBLISHER_PRODUCT_NAME,BROADCASTNAME,
 COUNT(*) COUNT
from DWMedProStaging.phm.tbExposureAndEngagementActivity(nolock)
where  startdatekey='20200808' and enddatekey='20200814' and Druglistmatchkey in ('4955')
and factopportunityname ='Mayzent Doc IQ'
--'Dayvigo RC'
GROUP BY CONTENT_LOCATION_NAME,CHANNEL_NAME,
SOURCE_HCP_ID_QUAL,ACTIVITY_NAME,
BRAND_NAME,
PUBLISHER_PRODUCT_NAME,BROADCASTNAME

Select SOURCE_HCP_ID_QUAL , Count(*) Counts
from DWMedProStaging.phm.tbHCPDetail
where  startdatekey='20200808' and enddatekey='20200814'  and  factopportunityname ='Mayzent Doc IQ'
--'Dayvigo RC
group by SOURCE_HCP_ID_QUAL;


--Details

SQL:

Select
SOURCE_HCP_ID_QUAL,SOURCE_HCP_ID,NPI,ME_ID,HCP_ID1_QUAL,HCP_ID1,HCP_ID2_QUAL,
HCP_ID2,HCP_ID3_QUAL,HCP_ID3,HCP_ID4_QUAL,HCP_ID4,HCP_ID5_QUAL,HCP_ID5,
FIRST_NAME,LAST_NAME,GENDER,DATE_OF_BIRTH,CREDENTIALS_DESC,SPECIALITY_DESC,
PRIMARY_ADDRESS_1,PRIMARY_ADDRESS_2,PRIMARY_ADDRESS_3,PRIMARY_CITY,PRIMARY_STATE,
PRIMARY_COUNTRY,PRIMARY_ZIP_CODE,SECONDARY_ADDRESS_1,SECONDARY_ADDRESS_2,SECONDARY_ADDRESS_3,
SECONDARY_CITY,SECONDARY_STATE,SECONDARY_COUNTRY,SECONDARY_ZIP_CODE,TERTIARY_ADDRESS_1,
TERTIARY_ADDRESS_2,TERTIARY_ADDRESS_3,TERTIARY_CITY,TERTIARY_STATE,TERTIARY_COUNTRY,
TERTIARY_ZIP_CODE,EMAIL_ADDRESS,TEL_NUMBER,FAX_NUMBER,HCP_SOURCE_LIST_TYPE,REP_ID_QUAL,
REP_ID,TERRITORY_CODE
From DWMedProStaging.phm.tbHCPDetail
where  startdatekey='20200701' and enddatekey='20200731' and fACTOPPORTUNITYNAME = 'Enhertu Doc IQ'

--record count



Select Count(*)RecordsCounts from (
Select
SOURCE_HCP_ID_QUAL,SOURCE_HCP_ID,NPI,ME_ID,HCP_ID1_QUAL,HCP_ID1,HCP_ID2_QUAL,
HCP_ID2,HCP_ID3_QUAL,HCP_ID3,HCP_ID4_QUAL,HCP_ID4,HCP_ID5_QUAL,HCP_ID5,
FIRST_NAME,LAST_NAME,GENDER,DATE_OF_BIRTH,CREDENTIALS_DESC,SPECIALITY_DESC,
PRIMARY_ADDRESS_1,PRIMARY_ADDRESS_2,PRIMARY_ADDRESS_3,PRIMARY_CITY,PRIMARY_STATE,
PRIMARY_COUNTRY,PRIMARY_ZIP_CODE,SECONDARY_ADDRESS_1,SECONDARY_ADDRESS_2,SECONDARY_ADDRESS_3,
SECONDARY_CITY,SECONDARY_STATE,SECONDARY_COUNTRY,SECONDARY_ZIP_CODE,TERTIARY_ADDRESS_1,
TERTIARY_ADDRESS_2,TERTIARY_ADDRESS_3,TERTIARY_CITY,TERTIARY_STATE,TERTIARY_COUNTRY,
TERTIARY_ZIP_CODE,EMAIL_ADDRESS,TEL_NUMBER,FAX_NUMBER,HCP_SOURCE_LIST_TYPE,REP_ID_QUAL,
REP_ID,TERRITORY_CODE
From DWMedProStaging.phm.tbHCPDetail
where  startdatekey='20200701' and enddatekey='20200731' and fACTOPPORTUNITYNAME = 'Enhertu Doc IQ')TGT--92


Select distinct ACTIVITY_DATETIME
from DWMedProStaging.phm.tbExposureAndEngagementActivity(nolock)
where startdatekey='20200701' and enddatekey='20200731' and fACTOPPORTUNITYNAME = 'Enhertu Doc IQ'

Select SOURCE_HCP_ID_QUAL,
SOURCE_HCP_ID,
NPI,
FIRST_NAME,
LAST_NAME,
PRIMARY_CITY,
PRIMARY_STATE,
PRIMARY_COUNTRY,
PRIMARY_ZIP_CODE
From DWMedProStaging.phm.tbHCPDetail
where startdatekey='20200701' and enddatekey='20200731' and fACTOPPORTUNITYNAME = 'Enhertu Doc IQ'
and SOURCE_HCP_ID_QUAL is null or
SOURCE_HCP_ID is null or
NPI is null or
FIRST_NAME is null or
LAST_NAME is null or
PRIMARY_CITY is null or
PRIMARY_STATE is null or
PRIMARY_ZIP_CODE is null


Select NPI
From DWMedProStaging.phm.tbHCPDetail
where  startdatekey='20200701' and enddatekey='20200731' and fACTOPPORTUNITYNAME = 'Enhertu Doc IQ'
and len(NPI)<>10


Select ME_ID
From DWMedProStaging.phm.tbHCPDetail
where  startdatekey='20200701' and enddatekey='20200731' and fACTOPPORTUNITYNAME = 'Enhertu Doc IQ'
and len(ME_ID)<>11 and ME_ID is not null

Select DATE_OF_BIRTH
From DWMedProStaging.phm.tbHCPDetail
where startdatekey='20200701' and enddatekey='20200731' and fACTOPPORTUNITYNAME = 'Enhertu Doc IQ'
and DATE_OF_BIRTH is not null


--Control feed file has record counts of both file for Activity exposure and details file, count are including header.
